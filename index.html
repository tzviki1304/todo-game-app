<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>משחק המשימות - הדרך להצלחה</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3f51b5;
            --primary-light: #7986cb;
            --primary-dark: #303f9f;
            --secondary: #ff4081;
            --success: #4caf50;
            --warning: #ff9800;
            --error: #f44336;
            --background: #f5f5f5;
            --paper: #ffffff;
            --text-primary: #212121;
            --text-secondary: #757575;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text-primary);
            direction: rtl;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .app-header {
            background-color: var(--primary);
            color: white;
            padding: 20px;
            border-radius: 10px 10px 0 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .app-title {
            font-size: 24px;
            font-weight: bold;
        }

        .stats {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .app-body {
            background-color: var(--paper);
            padding: 20px;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            min-height: 400px;
        }

        .form-group {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }

        .input-field {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .input-field:focus {
            border-color: var(--primary);
            outline: none;
        }

        .select-field {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            background-color: white;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .tasks-container {
            margin-top: 20px;
        }

        .task-list {
            list-style-type: none;
        }

        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            border-right: 5px solid var(--primary);
        }

        .task-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .task-item.completed {
            border-right-color: var(--success);
            opacity: 0.8;
            text-decoration: line-through;
            background-color: #f9f9f9;
        }

        .task-item.medium {
            border-right-color: var(--warning);
        }

        .task-item.high {
            border-right-color: var(--error);
        }

        .task-content {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }

        .task-checkbox {
            width: 22px;
            height: 22px;
            cursor: pointer;
        }

        .task-text {
            font-size: 16px;
        }

        .task-priority {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
        }

        .priority-low {
            background-color: var(--primary);
        }

        .priority-medium {
            background-color: var(--warning);
        }

        .priority-high {
            background-color: var(--error);
        }

        .task-actions {
            display: flex;
            gap: 5px;
        }

        .task-btn {
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        .edit-btn {
            background-color: var(--primary-light);
            color: white;
        }

        .delete-btn {
            background-color: var(--error);
            color: white;
        }

        .level-progress {
            margin-top: 20px;
            background-color: #ddd;
            border-radius: 20px;
            height: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--success);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
            transition: width 0.5s ease-in-out;
        }

        .reward-container {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff8e1;
            border-radius: 8px;
            border-right: 5px solid var(--warning);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .reward-title {
            font-size: 18px;
            color: var(--warning);
            margin-bottom: 10px;
        }

        .reward-message {
            font-size: 16px;
        }

        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid var(--primary);
            border-radius: 20px;
            background-color: transparent;
            color: var(--primary);
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        }

        .filter-btn.active {
            background-color: var(--primary);
            color: white;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            border-radius: 50%;
            animation: fall 5s ease-in infinite;
            z-index: 1000;
        }

        @keyframes fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .level-badge {
            background-color: var(--secondary);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .streaks {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        .streak-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #ddd;
        }

        .streak-dot.active {
            background-color: var(--success);
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 200px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .snackbar {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--paper);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 4px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .snackbar.show {
            opacity: 1;
        }

        .tab-container {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: border-color 0.3s, color 0.3s;
        }

        .tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .achievements-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .achievement-card {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: transform 0.3s;
        }

        .achievement-card:hover {
            transform: translateY(-5px);
        }

        .achievement-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-light);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .achievement-card.locked .achievement-icon {
            background-color: #ddd;
            color: #999;
        }

        .achievement-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .achievement-desc {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .achievement-card.locked {
            opacity: 0.7;
        }

        @media (max-width: 600px) {
            .form-group {
                flex-direction: column;
            }
            
            .task-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .task-actions {
                margin-top: 10px;
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="app-header">
            <div>
                <h1 class="app-title">משחק המשימות - הדרך להצלחה</h1>
                <div class="stats">
                    <div class="stat">
                        <i class="fas fa-tasks"></i>
                        <span id="total-tasks">0</span> משימות
                    </div>
                    <div class="stat">
                        <i class="fas fa-check-circle"></i>
                        <span id="completed-tasks">0</span> הושלמו
                    </div>
                    <div class="level-badge">
                        <i class="fas fa-trophy"></i>
                        רמה <span id="current-level">1</span>
                    </div>
                </div>
                <div class="streaks" id="streaks-container">
                    <!-- Streaks will be dynamically added here -->
                </div>
            </div>
        </header>

        <div class="app-body">
            <div class="tab-container">
                <div class="tab active" data-tab="tasks">משימות</div>
                <div class="tab" data-tab="achievements">הישגים</div>
            </div>

            <div class="tab-content active" id="tasks-tab">
                <div class="form-group">
                    <input type="text" id="task-input" class="input-field" placeholder="מה עליך לבצע?" autocomplete="off">
                    <select id="priority-select" class="select-field">
                        <option value="low">עדיפות נמוכה</option>
                        <option value="medium">עדיפות בינונית</option>
                        <option value="high">עדיפות גבוהה</option>
                    </select>
                    <button id="add-task-btn" class="btn btn-primary">
                        <i class="fas fa-plus"></i> הוסף
                    </button>
                </div>

                <div class="filters">
                    <button class="filter-btn active" data-filter="all">הכל</button>
                    <button class="filter-btn" data-filter="active">פעילות</button>
                    <button class="filter-btn" data-filter="completed">הושלמו</button>
                </div>

                <div class="tasks-container">
                    <ul id="task-list" class="task-list">
                        <!-- Tasks will be added here dynamically -->
                    </ul>
                    <div id="empty-state" class="empty-state">
                        <i class="fas fa-clipboard-list"></i>
                        <p>אין משימות עדיין. התחל להוסיף משימות!</p>
                    </div>
                </div>

                <div class="level-progress">
                    <div id="progress-bar" class="progress-bar" style="width: 0%">0%</div>
                </div>

                <div id="reward-container" class="reward-container">
                    <h3 class="reward-title"><i class="fas fa-gift"></i> ברכות! עלית רמה!</h3>
                    <p class="reward-message">השלמת את כל המשימות ועלית לרמה <span id="new-level">2</span>! המשך כך!</p>
                </div>
            </div>

            <div class="tab-content" id="achievements-tab">
                <div class="achievements-list" id="achievements-list">
                    <!-- Achievements will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>

    <div id="snackbar" class="snackbar">
        <i class="fas fa-info-circle"></i>
        <span id="snackbar-message"></span>
    </div>

    <script>
        // אפליקציית TODO בסגנון משחק הצלחות
        const TodoGame = (function() {
            // מבנה נתונים
            let state = {
                tasks: [],
                currentFilter: 'all',
                level: 1,
                xp: 0,
                xpToNextLevel: 100,
                streakDays: 0,
                lastActivity: null,
                achievements: [
                    {
                        id: 'first_task',
                        title: 'המתחיל',
                        description: 'הוספת את המשימה הראשונה שלך',
                        icon: 'fa-star',
                        unlocked: false
                    },
                    {
                        id: 'five_tasks',
                        title: 'יצירתי',
                        description: 'הוספת 5 משימות',
                        icon: 'fa-list',
                        unlocked: false
                    },
                    {
                        id: 'complete_3_tasks',
                        title: 'מתמיד',
                        description: 'השלמת 3 משימות',
                        icon: 'fa-check-double',
                        unlocked: false
                    },
                    {
                        id: 'high_priority',
                        title: 'אמיץ',
                        description: 'השלמת משימה בעדיפות גבוהה',
                        icon: 'fa-exclamation',
                        unlocked: false
                    },
                    {
                        id: 'streak_3',
                        title: 'עקבי',
                        description: 'שמרת על רצף של 3 ימים',
                        icon: 'fa-calendar-check',
                        unlocked: false
                    },
                    {
                        id: 'level_3',
                        title: 'מתקדם',
                        description: 'הגעת לרמה 3',
                        icon: 'fa-level-up-alt',
                        unlocked: false
                    }
                ]
            };

            // אלמנטים בממשק
            const elements = {
                taskInput: document.getElementById('task-input'),
                prioritySelect: document.getElementById('priority-select'),
                addTaskBtn: document.getElementById('add-task-btn'),
                taskList: document.getElementById('task-list'),
                emptyState: document.getElementById('empty-state'),
                totalTasks: document.getElementById('total-tasks'),
                completedTasks: document.getElementById('completed-tasks'),
                currentLevel: document.getElementById('current-level'),
                progressBar: document.getElementById('progress-bar'),
                rewardContainer: document.getElementById('reward-container'),
                newLevel: document.getElementById('new-level'),
                filterBtns: document.querySelectorAll('.filter-btn'),
                streaksContainer: document.getElementById('streaks-container'),
                snackbar: document.getElementById('snackbar'),
                snackbarMessage: document.getElementById('snackbar-message'),
                tabs: document.querySelectorAll('.tab'),
                tabContents: document.querySelectorAll('.tab-content'),
                achievementsList: document.getElementById('achievements-list')
            };

            // פונקציות עזר
            function generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            function saveState() {
                localStorage.setItem('todoGameState', JSON.stringify(state));
            }

            function loadState() {
                const savedState = localStorage.getItem('todoGameState');
                if (savedState) {
                    state = JSON.parse(savedState);
                    renderTasks();
                    updateStats();
                    updateStreaks();
                    updateAchievements();
                }
            }

            function showSnackbar(message) {
                elements.snackbarMessage.textContent = message;
                elements.snackbar.classList.add('show');
                setTimeout(() => {
                    elements.snackbar.classList.remove('show');
                }, 3000);
            }

            // פונקציות ניהול משימות
            function addTask() {
                const taskText = elements.taskInput.value.trim();
                const priority = elements.prioritySelect.value;

                if (taskText === '') {
                    showSnackbar('אנא הזן טקסט למשימה');
                    return;
                }

                const newTask = {
                    id: generateId(),
                    text: taskText,
                    completed: false,
                    priority: priority,
                    createdAt: new Date().toISOString()
                };

                state.tasks.push(newTask);
                elements.taskInput.value = '';
                elements.taskInput.focus();

                renderTasks();
                updateStats();
                saveState();

                addXp(10);
                
                // בדיקה האם זו המשימה הראשונה
                checkAchievement('first_task');
                // בדיקה האם הגענו ל-5 משימות
                if (state.tasks.length >= 5) {
                    checkAchievement('five_tasks');
                }

                // עדכון תאריך הפעילות האחרונה
                updateLastActivity();
            }

            function toggleTaskCompletion(taskId) {
                const taskIndex = state.tasks.findIndex(task => task.id === taskId);
                if (taskIndex === -1) return;

                const task = state.tasks[taskIndex];
                const wasCompleted = task.completed;
                task.completed = !task.completed;

                if (task.completed && !wasCompleted) {
                    // נותנים XP בהתאם לעדיפות המשימה
                    let xpGain = 10;
                    if (task.priority === 'medium') xpGain = 20;
                    if (task.priority === 'high') xpGain = 30;

                    addXp(xpGain);
                    
                    // בדיקת הישגים
                    const completedCount = state.tasks.filter(t => t.completed).length;
                    if (completedCount >= 3) {
                        checkAchievement('complete_3_tasks');
                    }
                    
                    if (task.priority === 'high') {
                        checkAchievement('high_priority');
                    }
                }

                renderTasks();
                updateStats();
                saveState();

                // עדכון תאריך הפעילות האחרונה
                updateLastActivity();
            }

            function editTask(taskId) {
                const task = state.tasks.find(task => task.id === taskId);
                if (!task) return;

                const newText = prompt('ערוך משימה:', task.text);
                if (newText !== null && newText.trim() !== '') {
                    task.text = newText.trim();
                    renderTasks();
                    saveState();
                }
            }

            function deleteTask(taskId) {
                if (confirm('האם אתה בטוח שברצונך למחוק משימה זו?')) {
                    state.tasks = state.tasks.filter(task => task.id !== taskId);
                    renderTasks();
                    updateStats();
                    saveState();
                }
            }

            // פונקציות רנדור ועדכון ממשק
            function renderTasks() {
                const { tasks, currentFilter } = state;
                
                // מסננים את המשימות לפי הפילטר הנוכחי
                const filteredTasks = tasks.filter(task => {
                    if (currentFilter === 'all') return true;
                    if (currentFilter === 'active') return !task.completed;
                    if (currentFilter === 'completed') return task.completed;
                    return true;
                });

                // בדיקה האם יש משימות להצגה
                if (filteredTasks.length === 0) {
                    elements.taskList.innerHTML = '';
                    elements.emptyState.style.display = 'flex';
                    return;
                }

                elements.emptyState.style.display = 'none';
                
                // בונים את רשימת המשימות
                elements.taskList.innerHTML = filteredTasks.map(task => {
                    const priorityClass = task.priority;
                    const completedClass = task.completed ? 'completed' : '';
                    
                    return `
                        <li class="task-item ${priorityClass} ${completedClass}" data-id="${task.id}">
                            <div class="task-content">
                                <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''}>
                                <span class="task-text">${task.text}</span>
                                <span class="task-priority priority-${task.priority}">
                                    ${task.priority === 'low' ? 'נמוכה' : task.priority === 'medium' ? 'בינונית' : 'גבוהה'}
                                </span>
                            </div>
                            <div class="task-actions">
                                <button class="task-btn edit-btn"><i class="fas fa-pencil-alt"></i></button>
                                <button class="task-btn delete-btn"><i class="fas fa-trash"></i></button>
                            </div>
                        </li>
                    `;
                }).join('');

                // מוסיפים מאזינים לאירועים
                attachTaskEventListeners();
            }

            function attachTaskEventListeners() {
                // תיבות הסימון להשלמת משימות
                document.querySelectorAll('.task-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        const taskId = e.target.closest('.task-item').dataset.id;
                        toggleTaskCompletion(taskId);
                    });
                });

                // כפתורי עריכה
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const taskId = e.target.closest('.task-item').dataset.id;
                        editTask(taskId);
                    });
                });

                // כפתורי מחיקה
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const taskId = e.target.closest('.task-item').dataset.id;
                        deleteTask(taskId);
                    });
                });
            }

            function updateStats() {
                const totalTasks = state.tasks.length;
                const completedTasks = state.tasks.filter(task => task.completed).length;
                
                elements.totalTasks.textContent = totalTasks;
                elements.completedTasks.textContent = completedTasks;
                elements.currentLevel.textContent = state.level;

                // עדכון שורת ההתקדמות
                const progress = Math.min(Math.round((state.xp / state.xpToNextLevel) * 100), 100);
                elements.progressBar.style.width = `${progress}%`;
                elements.progressBar.textContent = `${progress}%`;
            }

            // פונקציות XP ורמות
            function addXp(amount) {
                state.xp += amount;
                
                // בדיקה האם עלינו רמה
                if (state.xp >= state.xpToNextLevel) {
                    levelUp();
                }
                
                updateStats();
                saveState();
            }

            function levelUp() {
                state.level += 1;
                state.xp = state.xp - state.xpToNextLevel;
                state.xpToNextLevel = Math.floor(state.xpToNextLevel * 1.5);
                
                elements.newLevel.textContent = state.level;
                elements.rewardContainer.style.display = 'block';
                
                // בדיקת הישג של רמה 3
                if (state.level >= 3) {
                    checkAchievement('level_3');
                }
                
                // אפקט של קונפטי
                createConfetti();
                
                setTimeout(() => {
                    elements.rewardContainer.style.display = 'none';
                }, 5000);
            }

            function createConfetti() {
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    
                    // מגוון צבעים לקונפטי
                    const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4caf50', '#8bc34a', '#cddc39', '#ffeb3b', '#ffc107', '#ff9800', '#ff5722'];
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    
                    // מיקום אקראי
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    
                    document.body.appendChild(confetti);
                    
                    // הסרת הקונפטי לאחר סיום האנימציה
                    setTimeout(() => {
                        confetti.remove();
                    }, 5000);
                }
            }

            // פונקציות רצף (streak) ימים
            function updateLastActivity() {
                const today = new Date().toISOString().split('T')[0];
                const lastDate = state.lastActivity ? state.lastActivity.split('T')[0] : null;
                
                if (lastDate !== today) {
                    if (lastDate) {
                        // בדיקה האם זה היום שלאחר הפעילות האחרונה
                        const yesterday = new Date();
                        yesterday.setDate(yesterday.getDate() - 1);
                        const yesterdayStr = yesterday.toISOString().split('T')[0];
                        
                        if (lastDate === yesterdayStr) {
                            // רצף נמשך
                            state.streakDays += 1;
                            
                            // בדיקת הישג של רצף 3 ימים
                            if (state.streakDays >= 3) {
                                checkAchievement('streak_3');
                            }
                        } else {
                            // רצף נשבר
                            state.streakDays = 1;
                        }
                    } else {
                        // יום ראשון ברצף
                        state.streakDays = 1;
                    }
                    
                    state.lastActivity = new Date().toISOString();
                    updateStreaks();
                    saveState();
                }
            }

            function updateStreaks() {
                elements.streaksContainer.innerHTML = '';
                
                // יוצרים נקודות עבור הרצף
                for (let i = 0; i < 7; i++) {
                    const dot = document.createElement('div');
                    dot.className = 'streak-dot' + (i < state.streakDays ? ' active' : '');
                    elements.streaksContainer.appendChild(dot);
                }
            }

            // פונקציות הישגים
            function checkAchievement(achievementId) {
                const achievement = state.achievements.find(a => a.id === achievementId);
                if (achievement && !achievement.unlocked) {
                    achievement.unlocked = true;
                    saveState();
                    showSnackbar(`הישג חדש נפתח: ${achievement.title}!`);
                    updateAchievements();
                }
            }

            function updateAchievements() {
                elements.achievementsList.innerHTML = state.achievements.map(achievement => {
                    const lockedClass = achievement.unlocked ? '' : 'locked';
                    return `
                        <div class="achievement-card ${lockedClass}">
                            <div class="achievement-icon">
                                <i class="fas ${achievement.icon}"></i>
                            </div>
                            <div class="achievement-title">${achievement.title}</div>
                            <div class="achievement-desc">${achievement.description}</div>
                        </div>
                    `;
                }).join('');
            }

            // הגדרת מאזיני אירועים
            function setupEventListeners() {
                // הוספת משימה חדשה
                elements.addTaskBtn.addEventListener('click', addTask);
                elements.taskInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') addTask();
                });

                // פילטרים
                elements.filterBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        elements.filterBtns.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        state.currentFilter = btn.dataset.filter;
                        renderTasks();
                        saveState();
                    });
                });

                // טאבים
                elements.tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        elements.tabs.forEach(t => t.classList.remove('active'));
                        elements.tabContents.forEach(c => c.classList.remove('active'));
                        
                        tab.classList.add('active');
                        const tabId = tab.dataset.tab;
                        document.getElementById(`${tabId}-tab`).classList.add('active');
                    });
                });
            }

            // אתחול האפליקציה
            function init() {
                loadState();
                setupEventListeners();
                renderTasks();
                updateStats();
                updateStreaks();
                updateAchievements();
                
                // בדיקת רצף ימים בטעינה
                updateLastActivity();
            }

            // חשיפת API ציבורי
            return {
                init
            };
        })();

        // הפעלת האפליקציה
        document.addEventListener('DOMContentLoaded', TodoGame.init);
    </script>
</body>
</html>
